using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using System.IO;
using System.Linq;
using System;
using TMPro;

public class Image_Manager_shader : SingletonMono<Image_Manager>
{
    // string data = "{\"id\":\"e9040407-2f03-47e2-840a-ee4b26650221\",\"gaugePlanName\":\"testfordemo\",\"description\":\"testfordemo\",\"imoNumber\":\"7654321\",\"eventId\":\"b5ff3ea3-bad9-440a-9d31-f6dd6cc23ef9\",\"compartments\":[{\"assetName\":\"CARGO TANK 03 S\",\"assetUID\":\"14016069\",\"frames\":[{\"id\":\"e9040407-3511-4dca-8970-8225e9c8ceed\",\"frameName\":\"ShipHull\",\"frame_Id\":\"-1998038115\",\"plates\":[{\"id\":\"e9040407-3511-4d27-b8aa-1b73cfcbf10b\",\"plateName\":\"Plate13\",\"plate_Id\":\"-1955484318\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4987-9fe1-7138d4561301\",\"point_Id\":\"3\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-167.7\",\"y\":\"18.40353\",\"z\":\"27.24965\"},\"normal\":{\"x\":\"9.213141E-08\",\"y\":\"4.115474E-05\",\"z\":\"-0.9999999\"}},{\"id\":\"e9040407-3511-42ca-9ace-72fc73528d89\",\"point_Id\":\"4\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-157.8109\",\"y\":\"18.18371\",\"z\":\"27.24964\"},\"normal\":{\"x\":\"9.213141E-08\",\"y\":\"4.115474E-05\",\"z\":\"-0.9999999\"}}]},{\"id\":\"e9040407-3511-49c7-ab40-a2f27848da1b\",\"plateName\":\"Plate297\",\"plate_Id\":\"-63372160\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4814-b852-9016316a4f11\",\"point_Id\":\"2\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12,\"measuredThickness\":11,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-164.9907\",\"y\":\"21.69147\",\"z\":\"27.24979\"},\"normal\":{\"x\":\"9.213141E-08\",\"y\":\"4.115474E-05\",\"z\":\"-0.9999999\"}},{\"id\":\"e9040407-3511-4bdb-bb8a-dda1e2b3a336\",\"point_Id\":\"1\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12,\"measuredThickness\":11,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-158.5489\",\"y\":\"21.61738\",\"z\":\"27.24978\"},\"normal\":{\"x\":\"9.213141E-08\",\"y\":\"4.115474E-05\",\"z\":\"-0.9999999\"}}]}]},{\"id\":\"e9040407-3511-463d-8838-f345457b91ee\",\"frameName\":\"FR 84 NT\",\"frame_Id\":\"414311966\",\"plates\":[{\"id\":\"e9040407-3511-43ad-8b36-395ced3048f8\",\"plateName\":\"Plate9\",\"plate_Id\":\"821075912\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-43d4-9776-48da1aab8812\",\"point_Id\":\"9\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":17,\"measuredThickness\":15,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"2.21522\",\"z\":\"17.41416\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4540-a5ee-a1bc06542a0e\",\"plateName\":\"Plate26\",\"plate_Id\":\"-735073657\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4373-a279-527a2a473ef2\",\"point_Id\":\"5\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":9,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"23.72484\",\"z\":\"25.43268\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4da6-9cb4-d3bb9b3da85b\",\"point_Id\":\"6\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":9,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"18.15715\",\"z\":\"25.87898\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4ba5-aedd-a502a041c1df\",\"plateName\":\"Plate30\",\"plate_Id\":\"831010278\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4570-bcde-31ffdb4046e7\",\"point_Id\":\"7\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":14,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"11.65492\",\"z\":\"25.97021\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-42e1-aaab-fb94d78f95d1\",\"point_Id\":\"8\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":15,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"9.121385\",\"z\":\"25.97109\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4bf7-b0b3-dcb06703fa8a\",\"plateName\":\"Plate22\",\"plate_Id\":\"-735073661\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-48ad-80a5-93bb1714c7d8\",\"point_Id\":\"11\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"11.01245\",\"z\":\"10.77148\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4bd3-9bf2-fdb700dbad4b\",\"point_Id\":\"10\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"7.145575\",\"z\":\"10.97285\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-485a-b4c4-f6616371928f\",\"plateName\":\"Plate24\",\"plate_Id\":\"-735073659\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4483-99a4-16fb55f33449\",\"point_Id\":\"12\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"17.1634\",\"z\":\"10.90769\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4c1d-9a16-7da0e64ea9e3\",\"point_Id\":\"13\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":12,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"21.85088\",\"z\":\"11.01149\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4c66-8cde-f7f7e0b86bc2\",\"plateName\":\"Plate8\",\"plate_Id\":\"-745008029\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-47c4-9c65-118df0d0a05f\",\"point_Id\":\"14\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"25.83056\",\"z\":\"16.13047\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4f42-9e46-8f12875fb09e\",\"point_Id\":\"15\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-194\",\"y\":\"26.14936\",\"z\":\"19.24765\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]}]},{\"id\":\"e9040407-3511-4ab7-b7f2-f58a24bf7223\",\"frameName\":\"FR 81 SWASH BHD\",\"frame_Id\":\"-1256822217\",\"plates\":[{\"id\":\"e9040407-3511-4ff1-9688-21b8efff5ec2\",\"plateName\":\"Plate6\",\"plate_Id\":\"-259312550\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4ac2-9cb5-6c950046c1f4\",\"point_Id\":\"16\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":10,\"lifeRemaining\":2.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"23.43464\",\"z\":\"25.52808\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4367-a922-94e32b734908\",\"point_Id\":\"17\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":10,\"lifeRemaining\":2.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"18.59389\",\"z\":\"25.85693\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4a0d-b2ed-3661ad5c3d41\",\"plateName\":\"Plate49\",\"plate_Id\":\"959906233\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-489f-bf83-93aa8916afa4\",\"point_Id\":\"20\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":15,\"lifeRemaining\":1,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"2.275273\",\"z\":\"21.85645\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-488f-87a0-f011eb3abeeb\",\"point_Id\":\"21\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":15,\"lifeRemaining\":1,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"2.050928\",\"z\":\"16.01002\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4fd8-9f7a-5bd26cb70aca\",\"plateName\":\"Plate46\",\"plate_Id\":\"-1056516402\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4596-956d-660059c64734\",\"point_Id\":\"22\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":1.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"6.759636\",\"z\":\"11.70168\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4a00-a164-ebad688a629c\",\"point_Id\":\"23\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":1.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"11.83084\",\"z\":\"11.2317\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-45da-be53-6ec77eeb1eea\",\"plateName\":\"Plate43\",\"plate_Id\":\"-1816031289\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-4d53-8769-483917369070\",\"point_Id\":\"18\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":1.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"12.0677\",\"z\":\"26.06905\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4f1c-81ac-8c028849679d\",\"point_Id\":\"19\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":12,\"lifeRemaining\":0.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"8.317419\",\"z\":\"25.99296\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4f30-92c2-83ea25a4bb97\",\"plateName\":\"Plate40\",\"plate_Id\":\"-249947348\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-48ab-91f8-0139f394aa35\",\"point_Id\":\"24\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":11,\"lifeRemaining\":1.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"17.7166\",\"z\":\"11.13723\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-4eb7-b7a2-af3b9ae28354\",\"point_Id\":\"25\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":10,\"lifeRemaining\":2.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"23.44615\",\"z\":\"10.93662\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040407-3511-4be6-801d-e38d2f800d39\",\"plateName\":\"Plate34\",\"plate_Id\":\"2075651475\",\"gaugingPoints\":[{\"id\":\"e9040407-3511-412e-8ea2-002fcac8df2d\",\"point_Id\":\"27\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":9,\"lifeRemaining\":3.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"26.05464\",\"z\":\"22.98357\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040407-3511-428b-b9dd-18d7724d7bd3\",\"point_Id\":\"26\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":10,\"lifeRemaining\":2.5,\"ruleThickness\":0,\"location\":{\"x\":\"-178.1\",\"y\":\"26.77185\",\"z\":\"14.72413\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]}]}]}]}";
    //string data = "{\r\n    \"id\": \"e903110f-3532-42ad-93e1-a77b38189486\",\r\n    \"gaugePlanName\": \"test321\",\r\n    \"description\": \"test\",\r\n    \"imoNumber\": \"7370181\",\r\n    \"eventId\": \"6ed431c5-f511-4775-b351-172d619db2c6\",\r\n    \"compartments\": [\r\n        {\r\n            \"assetName\": \"Cargo Tank 03 S\",\r\n            \"assetUID\": \"14016069\",\r\n            \"frames\": [\r\n                {\r\n                    \"id\": \"e903120b-2204-4683-88b8-1d789a3cddd9\",\r\n                    \"frameName\": \"FR 85 NT\",\r\n                    \"frame_Id\": \"-1131568999\",\r\n                    \"plates\": [\r\n                        {\r\n                            \"id\": \"e903120b-2204-487f-bffc-5a15021bde4a\",\r\n                            \"plateName\": \"Plate4\",\r\n                            \"plate_Id\": \"-2068327468\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4176-9981-34b24bbd0df0\",\r\n                                    \"point_Id\": \"25\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-199.3\",\r\n                                        \"y\": \"15.40497\",\r\n                                        \"z\": \"10.6696\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2204-43fe-9daa-aa9a8076396a\",\r\n                                    \"point_Id\": \"24\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-199.3\",\r\n                                        \"y\": \"20.18535\",\r\n                                        \"z\": \"10.87042\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-4d64-b720-93a43b903162\",\r\n                            \"plateName\": \"Plate6\",\r\n                            \"plate_Id\": \"-905528054\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-401a-a1ad-885da0c63c13\",\r\n                                    \"point_Id\": \"23\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-199.3\",\r\n                                        \"y\": \"17.82155\",\r\n                                        \"z\": \"25.55419\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4512-a6ed-be9132d4a8d6\",\r\n                                    \"point_Id\": \"22\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-199.3\",\r\n                                        \"y\": \"23.09172\",\r\n                                        \"z\": \"26.07437\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"id\": \"e903120b-2204-4d6a-9c36-2b24b243358c\",\r\n                    \"frameName\": \"L10 - LBHD Stbd\",\r\n                    \"frame_Id\": \"-437677687\",\r\n                    \"plates\": [\r\n                        {\r\n                            \"id\": \"e903120b-2204-42d9-b4fb-9658c08299be\",\r\n                            \"plateName\": \"Plate115\",\r\n                            \"plate_Id\": \"1494160203\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-46a5-9dc3-6b29b9dfa653\",\r\n                                    \"point_Id\": \"12\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-199.8784\",\r\n                                        \"y\": \"9.735755\",\r\n                                        \"z\": \"9.399993\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"1\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-4d92-8d88-ac7edc899a2a\",\r\n                            \"plateName\": \"Plate116\",\r\n                            \"plate_Id\": \"1494160202\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-429d-a765-e8a1fc2571e1\",\r\n                                    \"point_Id\": \"19\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-190.0078\",\r\n                                        \"y\": \"4.401244\",\r\n                                        \"z\": \"9.399995\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-45e4-b97e-d216a0244d26\",\r\n                            \"plateName\": \"Plate113\",\r\n                            \"plate_Id\": \"1494160197\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4bc5-a702-0f3a871eec81\",\r\n                                    \"point_Id\": \"18\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-198.9799\",\r\n                                        \"y\": \"16.37418\",\r\n                                        \"z\": \"9.399991\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"1\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-49f7-ab35-e8da5a393cdd\",\r\n                            \"plateName\": \"Plate98\",\r\n                            \"plate_Id\": \"-1112432861\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4786-bbb4-521c1886dc2e\",\r\n                                    \"point_Id\": \"20\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-167.78\",\r\n                                        \"y\": \"14.91864\",\r\n                                        \"z\": \"9.399991\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"id\": \"e903120b-2204-4608-b90f-76336d92f803\",\r\n                    \"frameName\": \"Main Deck\",\r\n                    \"frame_Id\": \"-1143491428\",\r\n                    \"plates\": [\r\n                        {\r\n                            \"id\": \"e903120b-2204-4336-8a94-814c32d9bcd9\",\r\n                            \"plateName\": \"Plate361\",\r\n                            \"plate_Id\": \"1736399843\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4c07-bd73-37420c193a25\",\r\n                                    \"point_Id\": \"13\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 16,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-164.8221\",\r\n                                        \"y\": \"27.39228\",\r\n                                        \"z\": \"18.95306\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"0.9986338\",\r\n                                        \"z\": \"0.05225378\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4097-a744-e14a29815cbb\",\r\n                                    \"point_Id\": \"14\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 16,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-166.1445\",\r\n                                        \"y\": \"27.47064\",\r\n                                        \"z\": \"17.45549\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"0.9986338\",\r\n                                        \"z\": \"0.05225378\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-4909-80d5-9d8a84c4e242\",\r\n                            \"plateName\": \"Plate221\",\r\n                            \"plate_Id\": \"1595237346\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4579-a3c0-14484a87daf1\",\r\n                                    \"point_Id\": \"16\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 16,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-187.9535\",\r\n                                        \"y\": \"27.44817\",\r\n                                        \"z\": \"17.88495\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"0.9986338\",\r\n                                        \"z\": \"0.05225378\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4642-895c-db0f6f32d691\",\r\n                                    \"point_Id\": \"15\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 16,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-182.2193\",\r\n                                        \"y\": \"27.52538\",\r\n                                        \"z\": \"16.40934\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"0.9986338\",\r\n                                        \"z\": \"0.05225378\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"id\": \"e903120b-2203-4407-8476-97fdd8be20ff\",\r\n                    \"frameName\": \"ShipHull\",\r\n                    \"frame_Id\": \"1177330163\",\r\n                    \"plates\": [\r\n                        {\r\n                            \"id\": \"e903120b-2204-4987-9f93-6a7f45e51e2f\",\r\n                            \"plateName\": \"Plate249\",\r\n                            \"plate_Id\": \"569933127\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-46e9-968b-446ffb835ec9\",\r\n                                    \"point_Id\": \"21\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 24.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-207.4097\",\r\n                                        \"y\": \"1.69771\",\r\n                                        \"z\": \"26.86115\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"-1.362217E-06\",\r\n                                        \"y\": \"-0.4256562\",\r\n                                        \"z\": \"0.9048849\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-4ba7-b226-8bce917f105d\",\r\n                            \"plateName\": \"Plate491\",\r\n                            \"plate_Id\": \"1060677786\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4dfd-8c8c-9b890f71fff5\",\r\n                                    \"point_Id\": \"10\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-196.9496\",\r\n                                        \"y\": \"15.97563\",\r\n                                        \"z\": \"27.24999\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-4b87-9c2b-c810106acf47\",\r\n                            \"plateName\": \"Plate13\",\r\n                            \"plate_Id\": \"-1437872308\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-48fb-a411-3d06416a5337\",\r\n                                    \"point_Id\": \"7\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-170.4878\",\r\n                                        \"y\": \"17.91437\",\r\n                                        \"z\": \"27.24998\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"2.651257E-07\",\r\n                                        \"y\": \"-2.052352E-07\",\r\n                                        \"z\": \"1\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-4205-a1ab-d9042771e7c1\",\r\n                            \"plateName\": \"Plate466\",\r\n                            \"plate_Id\": \"-1311975224\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4cc1-acee-757a7ebb1a25\",\r\n                                    \"point_Id\": \"9\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-180.8717\",\r\n                                        \"y\": \"12.10815\",\r\n                                        \"z\": \"27.24999\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4a5f-9458-e3fa1ea8871d\",\r\n                                    \"point_Id\": \"8\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-176.9245\",\r\n                                        \"y\": \"12.55462\",\r\n                                        \"z\": \"27.24999\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-4e46-a736-d9ecfe57a0b0\",\r\n                            \"plateName\": \"Plate21\",\r\n                            \"plate_Id\": \"-1841156833\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4d25-8c42-390dc47fc8e8\",\r\n                                    \"point_Id\": \"11\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-192.7042\",\r\n                                        \"y\": \"19.40924\",\r\n                                        \"z\": \"27.24998\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"0\",\r\n                                        \"y\": \"3.576279E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2204-4ec7-b7d4-fbfde18401d0\",\r\n                            \"plateName\": \"Plate415\",\r\n                            \"plate_Id\": \"-908690690\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2204-4263-9a74-7daa13dce5b6\",\r\n                                    \"point_Id\": \"17\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-192.0765\",\r\n                                        \"y\": \"25.58535\",\r\n                                        \"z\": \"27.24998\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"3.375657E-07\",\r\n                                        \"y\": \"-4.860534E-07\",\r\n                                        \"z\": \"0.9999999\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                },\r\n                {\r\n                    \"id\": \"e903120b-2203-4c8f-a933-ede7bcaf06ef\",\r\n                    \"frameName\": \"FR 77 NT\",\r\n                    \"frame_Id\": \"1960204968\",\r\n                    \"plates\": [\r\n                        {\r\n                            \"id\": \"e903120b-2203-46f7-b090-0c6cc6de5f3e\",\r\n                            \"plateName\": \"Plate19\",\r\n                            \"plate_Id\": \"467343079\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4658-999b-26866d4c4ea7\",\r\n                                    \"point_Id\": \"2\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"26.20367\",\r\n                                        \"z\": \"15.24824\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4199-b915-b7e11172d26d\",\r\n                                    \"point_Id\": \"1\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"25.84905\",\r\n                                        \"z\": \"22.13454\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-46aa-919b-2429fb206379\",\r\n                            \"plateName\": \"Plate35\",\r\n                            \"plate_Id\": \"-695456331\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-47c7-937e-6ec394218e74\",\r\n                                    \"point_Id\": \"5\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"1.652378\",\r\n                                        \"z\": \"15.18331\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4e03-907e-7587205fdd8b\",\r\n                                    \"point_Id\": \"6\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 17,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"1.481396\",\r\n                                        \"z\": \"19.54728\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        {\r\n                            \"id\": \"e903120b-2203-4e87-9007-df88e4a6e2d1\",\r\n                            \"plateName\": \"Plate13\",\r\n                            \"plate_Id\": \"467343085\",\r\n                            \"gaugingPoints\": [\r\n                                {\r\n                                    \"id\": \"e903120b-2203-488d-8057-1730357bbe37\",\r\n                                    \"point_Id\": \"4\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"15.84454\",\r\n                                        \"z\": \"11.38739\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                },\r\n                                {\r\n                                    \"id\": \"e903120b-2203-4dba-b050-ec48f640e79e\",\r\n                                    \"point_Id\": \"3\",\r\n                                    \"isClass\": true,\r\n                                    \"isRepresentative\": false,\r\n                                    \"originalThickness\": 12.5,\r\n                                    \"measuredThickness\": -1,\r\n                                    \"lifeRemaining\": 0,\r\n                                    \"ruleThickness\": 0,\r\n                                    \"location\": {\r\n                                        \"x\": \"-156.9\",\r\n                                        \"y\": \"21.65769\",\r\n                                        \"z\": \"9.634317\"\r\n                                    },\r\n                                    \"normal\": {\r\n                                        \"x\": \"1\",\r\n                                        \"y\": \"0\",\r\n                                        \"z\": \"0\"\r\n                                    }\r\n                                }\r\n                            ]\r\n                        }\r\n                    ]\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}";
    string data = "{\"id\":\"e9031f0b-3a34-48a0-859a-0af845bc34e0\",\"gaugePlanName\":\"tescz\",\"description\":\"Gauge Plan Name\",\"imoNumber\":\"7654321\",\"eventId\":\"b5ff3ea3-bad9-440a-9d31-f6dd6cc23ef9\",\"compartments\":[{\"assetName\":\"CARGO TANK 03 S\",\"assetUID\":\"14016069\",\"frames\":[{\"id\":\"e9040208-2520-4a2e-b7e9-d9338c3c4faf\",\"frameName\":\"FR 82 NT\",\"frame_Id\":\"1617517332\",\"plates\":[{\"id\":\"e9040208-2520-47e3-8430-21d851bc5983\",\"plateName\":\"BKT4_1\",\"plate_Id\":\"341845718\",\"gaugingPoints\":[{\"id\":\"e9040208-2520-4a0c-a54b-f1070decbd53\",\"point_Id\":\"7\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.8645\",\"y\":\"9.050004\",\"z\":\"25.902\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-49e7-a25a-7da16c38ad6e\",\"plateName\":\"Plate2\",\"plate_Id\":\"-924953969\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4ab2-a341-8617c51f3862\",\"point_Id\":\"14\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4\",\"y\":\"26.08326\",\"z\":\"17.06627\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040208-2521-4a00-939d-9f63629c04da\",\"point_Id\":\"13\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4\",\"y\":\"25.98888\",\"z\":\"23.11597\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2520-46cc-a865-8a82cf4a4dda\",\"plateName\":\"BKT173_1\",\"plate_Id\":\"1947077247\",\"gaugingPoints\":[{\"id\":\"e9040208-2520-4081-81ce-857a248883bb\",\"point_Id\":\"5\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.7653\",\"y\":\"10.75\",\"z\":\"26.01112\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}},{\"id\":\"e9040208-2520-410f-8274-ff92f3126748\",\"point_Id\":\"6\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4669\",\"y\":\"10.75\",\"z\":\"24.55519\"},\"normal\":{\"x\":\"0\",\"y\":\"-1\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2520-4a20-8aaa-beca39096f02\",\"plateName\":\"BKT154_1\",\"plate_Id\":\"-1084334152\",\"gaugingPoints\":[{\"id\":\"e9040208-2520-463e-879c-53bc956f7fe4\",\"point_Id\":\"2\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.8004\",\"y\":\"17.55\",\"z\":\"25.72063\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}},{\"id\":\"e9040208-2520-417a-b7e6-8ecda71d59a9\",\"point_Id\":\"1\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.5916\",\"y\":\"17.55\",\"z\":\"26.28017\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-4431-9395-d30cf059f42a\",\"plateName\":\"Plate18\",\"plate_Id\":\"294833986\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4986-9bdb-caa68061a241\",\"point_Id\":\"17\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4\",\"y\":\"24.20048\",\"z\":\"10.38952\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2520-4232-948a-d99b7b4df2af\",\"plateName\":\"Stiffener201-1-1\",\"plate_Id\":\"-1202317370\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-44c1-9fb9-a27faee253b6\",\"point_Id\":\"11\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":15,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.5688\",\"y\":\"7.453201\",\"z\":\"11.26635\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.000623205\",\"z\":\"-0.9999998\"}},{\"id\":\"e9040208-2521-40d2-937c-f618de45186c\",\"point_Id\":\"12\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":15,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4794\",\"y\":\"13.29096\",\"z\":\"11.26271\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.000623205\",\"z\":\"-0.9999998\"}}]},{\"id\":\"e9040208-2520-4267-b8c2-ea5c45ba36a2\",\"plateName\":\"Stiffener198-1-1\",\"plate_Id\":\"656692431\",\"gaugingPoints\":[{\"id\":\"e9040208-2520-48a2-b5fb-860385ed3e22\",\"point_Id\":\"10\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":15,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.5084\",\"y\":\"12.54963\",\"z\":\"25.35728\"},\"normal\":{\"x\":\"0\",\"y\":\"0.002910091\",\"z\":\"-0.9999958\"}},{\"id\":\"e9040208-2520-4bb6-8ad9-abdfb7367141\",\"point_Id\":\"9\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":15,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.5137\",\"y\":\"22.02266\",\"z\":\"25.38485\"},\"normal\":{\"x\":\"0\",\"y\":\"0.002910091\",\"z\":\"-0.9999958\"}},{\"id\":\"e9040208-2520-48ac-979e-e507b2d8c56c\",\"point_Id\":\"8\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":15,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4599\",\"y\":\"23.6734\",\"z\":\"25.38966\"},\"normal\":{\"x\":\"0\",\"y\":\"0.002910091\",\"z\":\"-0.9999958\"}}]},{\"id\":\"e9040208-2521-4eee-b376-fbb8f5ba7f02\",\"plateName\":\"Plate3\",\"plate_Id\":\"641129972\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-482f-92a1-0706214caf27\",\"point_Id\":\"15\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":17,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4\",\"y\":\"1.518785\",\"z\":\"18.86249\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040208-2521-4457-a642-2ce13a6177f9\",\"point_Id\":\"16\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":17,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.4\",\"y\":\"1.191895\",\"z\":\"13.61751\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2520-4059-a08a-ff9a60d1903d\",\"plateName\":\"BKT75_1\",\"plate_Id\":\"2012679522\",\"gaugingPoints\":[{\"id\":\"e9040208-2520-44c2-bc57-ab3daff0b19f\",\"point_Id\":\"3\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-184.1399\",\"y\":\"15.85\",\"z\":\"26.48877\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}},{\"id\":\"e9040208-2520-43a9-9519-c13d8521c4fd\",\"point_Id\":\"4\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-183.6839\",\"y\":\"15.85\",\"z\":\"25.16016\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]}]},{\"id\":\"e9040208-2521-4385-a413-f78f9472ca18\",\"frameName\":\"FR 83 NT\",\"frame_Id\":\"-1413894001\",\"plates\":[{\"id\":\"e9040208-2521-488a-bfb3-04b754bd7594\",\"plateName\":\"Plate27\",\"plate_Id\":\"582925737\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4914-b654-e50c29c3ad39\",\"point_Id\":\"28\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":16,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.7\",\"y\":\"2.087793\",\"z\":\"24.9175\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2521-4f32-8064-1f4c07245b1a\",\"plateName\":\"Plate2\",\"plate_Id\":\"2092021140\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4a79-94a7-0d09cc7317b5\",\"point_Id\":\"25\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.7\",\"y\":\"26.11892\",\"z\":\"16.98479\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040208-2521-4db3-abc5-7770aa18eef0\",\"point_Id\":\"24\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.7\",\"y\":\"26.14623\",\"z\":\"22.8894\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2521-49d2-a913-2194f5cdceb1\",\"plateName\":\"BKT142_1\",\"plate_Id\":\"-1224093124\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4632-baeb-7ba81719682a\",\"point_Id\":\"18\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.9991\",\"y\":\"17.55\",\"z\":\"25.72165\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-482f-92fb-3880481a3041\",\"plateName\":\"BKT146_1\",\"plate_Id\":\"-1788743128\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-46a4-8c15-a67b136abc42\",\"point_Id\":\"20\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.9955\",\"y\":\"10.75\",\"z\":\"25.66614\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-4e06-acc6-612c20a3516c\",\"plateName\":\"BKT31_1\",\"plate_Id\":\"1822304837\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-43a0-8cf5-d8b6b270d991\",\"point_Id\":\"19\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-189.0225\",\"y\":\"15.85\",\"z\":\"25.80672\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-4e79-9441-9046f18957e8\",\"plateName\":\"BKT28_1\",\"plate_Id\":\"518343153\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-48b0-981d-62e12e0aeaae\",\"point_Id\":\"22\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.8192\",\"y\":\"9.049998\",\"z\":\"10.81069\"},\"normal\":{\"x\":\"0\",\"y\":\"0.9999999\",\"z\":\"-3.576279E-07\"}}]},{\"id\":\"e9040208-2521-430b-92dd-abd2c60dc8a6\",\"plateName\":\"Plate3\",\"plate_Id\":\"525937199\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4326-8f10-1569a50610a8\",\"point_Id\":\"26\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":17,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.7\",\"y\":\"1.560488\",\"z\":\"13.35954\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}},{\"id\":\"e9040208-2521-4e8c-bc8a-7c2d0a0c9227\",\"point_Id\":\"27\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":17,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.7\",\"y\":\"1.562786\",\"z\":\"18.548\"},\"normal\":{\"x\":\"-1\",\"y\":\"0\",\"z\":\"0\"}}]},{\"id\":\"e9040208-2521-4740-bba7-d223b0664d3b\",\"plateName\":\"BKT171_1\",\"plate_Id\":\"-800605586\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4d08-832d-01ff8f717ffe\",\"point_Id\":\"21\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-189.0553\",\"y\":\"9.050004\",\"z\":\"25.72998\"},\"normal\":{\"x\":\"0\",\"y\":\"-0.9999999\",\"z\":\"3.576279E-07\"}}]},{\"id\":\"e9040208-2521-461b-a54a-efad6020da7f\",\"plateName\":\"BKT199_1\",\"plate_Id\":\"328694480\",\"gaugingPoints\":[{\"id\":\"e9040208-2521-4fd9-b8e1-e7efb79e41eb\",\"point_Id\":\"23\",\"isClass\":true,\"isRepresentative\":false,\"originalThickness\":12.5,\"measuredThickness\":-1,\"lifeRemaining\":0,\"ruleThickness\":0,\"location\":{\"x\":\"-188.9483\",\"y\":\"15.85\",\"z\":\"11.03109\"},\"normal\":{\"x\":\"0\",\"y\":\"0.9999999\",\"z\":\"-3.576279E-07\"}}]}]}]}]}";
    [SerializeField] private Camera mainCamera;
    [SerializeField] private Camera screenshotCamera;
    [SerializeField] private string savePath = "D:/Screenshot/";

    [SerializeField] private TextMeshProUGUI frameText;
    [SerializeField] private TextMeshProUGUI compartmentText;
    [SerializeField] private Material bracket_Mat;
    [SerializeField] private Material stiffner_Mat;

    [SerializeField] private Color stiffner_GP;
    [SerializeField] private Color bracket_GP;
    [SerializeField] private Color plate_GP;


    private void Start()
    {
        // 1. Temp - to test screenshot localy
#if UNITY_EDITOR
        System.IO.Directory.CreateDirectory(savePath);
        frameText.text = "No Object Selected";
        compartmentText.text = "No Object Selected";
#endif
    }

    public override void Update()
    {
        if (UnityEngine.Input.GetKeyDown(KeyCode.Keypad1))
        {
            CaptureHullPartScreenshot(data);
        }
    }

    public bool bracketsToggled = false;
    public bool stiffnerToggled = false;

    // Receive Hull Part Name & Capture Screenshot
    public void CaptureHullPartScreenshot(string data)
    {
        GaugePointsData_External deserializedData = JsonUtility.FromJson<GaugePointsData_External>(data);

        GaugingManager.Instance.ClearGaugePoints();
        if (CommunicationManager.Instance.bracketsActive)
        {
            bracketsToggled = true;
            //CommunicationManager.Instance.HideBrackets_Extern();
            //CommunicationManager.Instance.HideStiffeners_Extern();
        }
        Debug.Log("Deserialized Data " + deserializedData);
        GaugingManager.Instance.SpawnLoadedGaugePoints(deserializedData, () => 
        {
            //GaugingPointIndicator.SetAllGaugePointsForOverDraw();
            GaugingPointIndicator.ChangeColor(new ColoringData()
            {
                colorForPlates = plate_GP,
                colorForBrackets = bracket_GP,
                colorForStiffeners = stiffner_GP,
            });
            var frameNames = deserializedData.compartments.SelectMany(c => c.frames.Select(f => $"{c.assetUID}/{f.frameName}")).ToList();

            CommunicationManager.Instance.WireframeMode_Extern();

            StartCoroutine(CaptureScreenshot(0, frameNames, deserializedData));
        });
    }

    // Position Camera
    private void PositionCamera(Hullpart targetObject)
    {
        if (targetObject == null || screenshotCamera == null) return;

        Collider col = targetObject.GetCollider().gameObject.GetComponent<Collider>();
        Bounds bounds = targetObject.GetCollider().gameObject.GetComponent<Renderer>().bounds;



        Vector3 objectCenter = bounds.center;
        float objectSize = Mathf.Max(bounds.size.x, bounds.size.y, bounds.size.z);
        float distance = objectSize * 2.5f;

        screenshotCamera.transform.LookAt(objectCenter);


        Debug.Log("Reached here");

        // Retrieve metadata and adjust camera rotation based on IDX_SHORTDESC
        MetadataComponent metadata = targetObject.hullpartMeshReference.GetComponent<MetadataComponent>();

        if (metadata != null && metadata.metadatalookUp.TryGetValue("IDX_SHORTDESC", out string shortDesc))
        {
            Debug.Log($"IDX_SHORTDESC found: {shortDesc}");

            // Apply rotation based on the value 
            if (shortDesc == "WFR" || shortDesc == "BH")
            {
                screenshotCamera.transform.rotation = Quaternion.Euler(0, 90, 0);
            }
            else if (shortDesc == "D")
            {
                screenshotCamera.transform.rotation = Quaternion.Euler(90, 0, 180);
            }
            else if (shortDesc == "LBH" || shortDesc == "SH")
            {
                screenshotCamera.transform.rotation = Quaternion.Euler(0, 180, 0);
            }

            Debug.Log($"Camera rotated based on metadata: {screenshotCamera.transform.rotation.eulerAngles}");
        }

        screenshotCamera.transform.position = objectCenter - (screenshotCamera.transform.forward * distance);

        if (frameText != null)
        {
            frameText.text = "Hullpart : " + targetObject.name;
        }
        Debug.Log("Camera repositioned for: " + targetObject.name);

    }

    // Capture Screenshot
    private IEnumerator CaptureScreenshot(int index, List<string> framePaths, GaugePointsData_External deserializedData)
    {
        if (index >= framePaths.Count)
        {

            Debug.Log("Returning to main camera.");
            CommunicationManager.Instance.OpaqueMode_Extern("1");

            GaugingManager.Instance.ClearGaugePoints();
            CameraService.Instance.cameraTransform = mainCamera.transform;
            string jsonData = JsonUtility.ToJson(deserializedData, true);
            CommunicationManager.Instance.HandleCapturedImagesForExport_Extern(jsonData);

            if (bracketsToggled)
            {
                bracketsToggled = false;
               // CommunicationManager.Instance.ToggleBrackets_Extern();
               // CommunicationManager.Instance.ToggleStiffeners_Extern();
            }

            ServiceRunner.GetService<LoadingScreenService>().SetLoadingScreenActive(false);


            yield break;
        }

        ServiceRunner.GetService<LoadingScreenService>().SetLoadingScreenActive(true, "Capturing Screenshot ...");

        CameraService.Instance.cameraTransform = screenshotCamera.transform;
        var breadCrums = framePaths[index].Split('/');
        var compartmentName = breadCrums[0];
        var hullpartName = breadCrums[1];

        compartmentText.text = "Compartment : " + GroupingManager.Instance.vesselObject.GetCompartmentName(compartmentName); ;

        GroupingManager.Instance.vesselObject.GetCompartments(c => c).ForEach(c =>
        {
            c.SetActive(c.uid == compartmentName);
        });
        GroupingManager.Instance.vesselObject.GetHullparts(compartmentName, h => h).ForEach(h =>
        {
            h.SetActiveByType(h.name == hullpartName, SubpartType.Plate);
            h.SetActiveByType(h.name == hullpartName, SubpartType.Bracket);
            h.SetActiveByType(h.name == hullpartName, SubpartType.Stiffener);
        });

        List<Subpart> changedCollection = new List<Subpart>();

        //GroupingManager.Instance.vesselObject.RunOverSubparts(compartmentName, hullpartName, s =>
        //{
        //    if (s.type == SubpartType.Stiffner)
        //    {
        //        s.ChangeMaterialTemparory(stiffner_Mat);
        //        changedCollection.Add(s);
        //    }
        //    if (s.type == SubpartType.Bracket)
        //    {
        //        s.ChangeMaterialTemparory(bracket_Mat);
        //        changedCollection.Add(s);
        //    }
        //});

        //GaugingManager.Instance.IsolateGaugePoints(compartmentName, hullpartName);

        PositionCamera(GroupingManager.Instance.vesselObject.GetHullpart(compartmentName, hullpartName));

        yield return new WaitForEndOfFrame();

        GaugingPointIndicator.LookAt(screenshotCamera);

        ObjectLabeler.Instance.CreateLabelsForAllObjects(GroupingManager.Instance.vesselObject.GetHullpart(compartmentName, hullpartName));
        yield return new WaitForEndOfFrame();

        //GaugingPointIndicator.ShowPlateIndiactors();
        //yield return new WaitForEndOfFrame();

        int width = Screen.width;
        int height = Screen.height;

        // Use RenderTexture.GetTemporary() for better memory management
        RenderTexture rt = RenderTexture.GetTemporary(width, height, 24);
        screenshotCamera.targetTexture = rt;
        screenshotCamera.Render();

        RenderTexture.active = rt;
        Texture2D sceneScreenshot = new Texture2D(width, height, TextureFormat.RGBA64, false);
        sceneScreenshot.ReadPixels(new Rect(0, 0, width, height), 0, 0);
        sceneScreenshot.Apply();

        screenshotCamera.targetTexture = null;
        RenderTexture.active = null;
        RenderTexture.ReleaseTemporary(rt);

#if UNITY_EDITOR
        // Save Screenshot Asynchronously
        string filePath = Path.Combine(savePath, $"{hullpartName}_Screenshot.png");
        byte[] bytes = sceneScreenshot.EncodeToPNG();
        System.IO.File.WriteAllBytes(filePath, bytes);
#endif

        string base64String = Convert.ToBase64String(sceneScreenshot.EncodeToPNG());
        deserializedData.compartments.Where(c => c.assetUID == compartmentName).FirstOrDefault().
        frames.Where(f => f.frameName == hullpartName).FirstOrDefault().frameImage = base64String;

//#if UNITY_EDITOR
//        // Save base64 string to .txt file for debugging
//        string base64FilePath = Path.Combine(savePath, $"{hullpartName}_Base64.txt");
//        File.WriteAllText(base64FilePath, base64String);
//        Debug.Log("Base64 string saved to: " + base64FilePath);
//#endif


        //Debug.Log("Image captured string: " + base64String);

        Destroy(sceneScreenshot);

        GroupingManager.Instance.vesselObject.GetCompartments(c => c).ForEach(c =>
        {
            if (ApplicationStateMachine.Instance.currentStateName == nameof(CompartmentViewState))
            {
                string targettedCompartmentName = (ApplicationStateMachine.Instance.CurrentState as CompartmentViewState).GetTargettedCompartemnt();
                c.SetActive(c.uid == targettedCompartmentName);
            }
            else
            {
                c.SetActive(true);
            }
        });

        //foreach (var item in changedCollection)
        //{
        //    item.RestMaterialToOriginal();
        //}

        GroupingManager.Instance.vesselObject.GetHullparts(compartmentName, h => h).ForEach(h =>
        {
            h.SetActive(true);
            if (ApplicationStateMachine.Instance.currentStateName == nameof(VesselViewState))
            {
                h.GetCollider().enabled = false;
            }
        });

        ObjectLabeler.Instance.ClearLabels();
        yield return null;

        index++;
        StartCoroutine(CaptureScreenshot(index, framePaths, deserializedData));
    }
}
